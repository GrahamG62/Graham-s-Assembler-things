         MACRO
         MACA  &mf,&wk
.*     *--------------------------------------------------------------*
.*     * maca Initialise Parameter list                              *
.*     *--------------------------------------------------------------*
&wkr     setc  '&wk'
         aif   (t'&wk ne 'O').aca010
&wkr     setc  '14'

.*     *--------------------------------------------------------------*
.*     * Decide on how plist is specified                             *
.*     *--------------------------------------------------------------*
.aca010  anop
         aif   (n'&mf eq 2).aca040     . mf=(x,y)
         aif   (n'&mf eq 1).aca030     . mf=(x)
         aif   (t'&mf ne 'O').aca020   . mf=label
         mnote 8,'maca - Missing parameter list'
         mexit

.*     *--------------------------------------------------------------*
.*     * mf=label                                                     *
.*     *--------------------------------------------------------------*
.aca20   anop
         la    &wkr,&mf            * Address parmlist
         mexit

.*     *--------------------------------------------------------------*
.*     * mf=(Rx)                                                      *
.*     *--------------------------------------------------------------*
.aca030  anop
&wxr     setc  '&mf(2)'(2,(k'&mf(2)-2))
         lr    &wkr,&wxr
         mexit

.*     *--------------------------------------------------------------*
.*     * mf=(x,y)                                                     *
.*     *--------------------------------------------------------------*
.aca040  anop
&mf1     setc  (upper '&mf(1)')
         aif   ('&mf1' eq 'E').aca050
         mnote 8,'maca - Invalid mf= parameter ''&mf1'''
         mexit

.*     *--------------------------------------------------------------*
.*     * mf=(E,label)                                                 *
.*     *--------------------------------------------------------------*
.aca050  anop
         aif   ('&mf(2)'(1,1) eq '(').aca060
         la    &wkr,&mf(2)
         mexit

.*     *--------------------------------------------------------------*
.*     * mf=(E,(Rx))                                                  *
.*     *--------------------------------------------------------------*
.aca060  anop
&wxr     setc  '&mf(2)'(2,(k'&mf(2)-2))
         lr    &wkr,&wxr
         MEND
